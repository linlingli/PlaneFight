{"version":3,"sources":["file:///Users/lipeiling/PlaneFight/assets/Scritps/GameManager.ts"],"names":["_decorator","Component","director","Node","BombUI","ScoreUI","Player","GameOverUI","ccclass","property","GameManager","getInstance","instance","onLoad","start","update","deltaTime","AddBomb","bombNumber","bombUI","updateUI","GetBombNumber","addScore","s","score","scoreUI","onPauseButtonClick","pause","player","disableControl","pauseButtonNode","active","resumeButtonNode","onResumeButtonClick","resume","enableControl","gameOver","hScore","localStorage","getItem","hScoreInt","parseInt","setItem","toString","gameOveerUI","showGameOverUI","onRestartButtonClick","loadScene","getScene","name"],"mappings":"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","sourcesContent":["import { _decorator, Component, director, Node } from 'cc';\nimport { BombUI } from './UI/BombUI';\nimport { ScoreUI } from './UI/ScoreUI';\nimport { Player } from './Player';\nimport { GameOverUI } from './UI/GameOverUI';\nconst { ccclass, property } = _decorator;\n\n@ccclass('GameManager')\nexport class GameManager extends Component {\n\n    // 單例模式\n    private static instance: GameManager\n    public static getInstance(): GameManager {\n        return this.instance;\n    }\n\n    @property\n    private bombNumber: number = 0;\n    @property(BombUI)\n    bombUI:BombUI = null\n\n    @property(ScoreUI)\n    scoreUI:ScoreUI = null\n\n    @property\n    private score:number = 0 // 不經由代碼修改\n\n    @property(Player)\n    player:Player = null\n\n    @property(Node)\n    pauseButtonNode:Node = null\n    @property(Node)\n    resumeButtonNode:Node = null\n\n    @property(GameOverUI)\n    gameOveerUI:GameOverUI = null\n\n    protected onLoad(): void { // 初始化 更早於start的生命週期\n        GameManager.instance = this;\n    }\n\n    start() {\n\n    }\n\n    update(deltaTime: number) {\n\n    }\n\n    public AddBomb() {\n        this.bombNumber++;\n        this.bombUI.updateUI(this.bombNumber)\n    }\n    public GetBombNumber():number{\n        return this.bombNumber\n    }\n    public addScore(s:number){\n        this.score+=s\n        this.scoreUI.updateUI(this.score)\n    }\n\n    onPauseButtonClick(){\n        director.pause() // update方法不再執行  沒有新的幀時間產生\n        this.player.disableControl()\n        this.pauseButtonNode.active = false\n        this.resumeButtonNode.active = true\n    }\n    onResumeButtonClick(){\n        director.resume()\n        this.player.enableControl()\n        this.pauseButtonNode.active = true\n        this.resumeButtonNode.active = false\n    }\n    gameOver(){ // 顯示game over ui 更新分數\n        director.pause()\n\n        let hScore = localStorage.getItem(\"HighestScore\")\n        let hScoreInt = 0\n\n        if(hScore !== null){\n            hScoreInt = parseInt(hScore,10)\n        }\n        if(this.score>hScoreInt){\n            localStorage.setItem(\"HighestScore\",this.score.toString())\n        }\n        this.gameOveerUI.showGameOverUI(hScoreInt,this.score)\n    }\n    onRestartButtonClick(){\n        this.onResumeButtonClick()\n        director.loadScene(director.getScene().name)\n    }\n}\n\n"]}